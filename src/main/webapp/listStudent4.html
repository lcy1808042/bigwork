<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>显示学生信息</title>
    <link rel="stylesheet" href="./bootstrap-5.0.0-beta1-dist/css/bootstrap.css">
    <script src="./js/jquery-3.5.1.min.js"></script>
</head>

<style>
    img{
        width: 100px;
        height: 100px;
    }

</style>

<body>
<h1 align="center">软件工程18级学生信息表</h1>
<hr>
<form action="listStudentsByPaging.jsp" method="post">
    请输入姓名：<input type="text" id="userName" name="userName">
    <input type="submit" value="确定" id="submit" name="submit">
</form>
<hr>
<table id="students" class="table table-bordered table-striped">

    <tr>
        <td>学号</td>
        <td>姓名</td>
        <td>班级</td>
        <td>性别</td>
        <td>系部</td>
        <td>电话</td>
        <td>宿舍号</td>
        <td>照片</td>
        <td>操作</td>
        <td>操作</td>
    </tr>

</table>
<script>
    //使用jquery重写ajax
    //1,页面加载后自动执行函数
    $(function () {

        //2，jquery ajax
        $.ajax({
            url:"listStudentServlet2",
            type:"POST",
            data:{},
            success:function (data) {
                var students = JSON.parse(data);
                //使用jquery创建tr
                 for(index in students){
                    console.log(students[index].stuNo," ",students[index].stuName)
                 }
                for (s of students){
                    var tr="<tr>"
                    for(var i in s){
                        // console.log(s[i],"  ")
                        if(i!="photoPath") {
                            tr += "<td>" + s[i] + "</td>td>"
                        }else{
                            tr+="<td><img src='"+s[i]+"'/></td>"
                        }
                    }
                    tr+="<td><a href='deleteStudent.jsp'>删除</a>&nbsp;<a href='updatestudent.jsp'>更新</a> </td>"
                    tr+="</tr>"
                    $("#students tr:last").after(tr);
                }
            },
            error:function () {
                console.log("发生错误，请处理")
            }
        });
    });


    // var tables=document.getElementById("students");
    // var xhr = new XMLHttpRequest();
    //
    // xhr.onreadystatechange = function() {
    //     if (xhr.readyState === XMLHttpRequest.DONE) {
    //         if (xhr.status==200) {
    //             //alert(data);
    //             var students = JSON.parse(xhr.responseText);
    //             for(var s of students){
    //                 // console.log(s["stuName"]);
    //                 //创建行
    //                 var tr=document.createElement("tr");
    //                 //创建列
    //                 for(index in s){
    //                     //把students值复制到列
    //                     var td=document.createElement("td")
    //                     if(index!="photoPath") {
    //                         td.innerText = s[index]
    //                         //把列加入到行
    //                         tr.append(td)
    //                     }else{
    //                         var img=document.createElement("img")
    //                         img.src=s[index]
    //                         td.append(img)
    //                         tr.append(td)
    //                     }
    //                 }
    //
    //                 var option=document.createElement("td");
    //                 option.innerHTML="<a href='#'>删除</a>&nbsp;<a href='#'>更新</a>";
    //                 tr.append(option)
    //                 //把行追加到table中
    //                 tables.append(tr)
    //             }
    //         }
    //
    //        // tables.append(tr)
    //
    //
    //     }
    // };
    // xhr.open('POST', 'listStudentServlet2');
    // xhr.send();
</script>
</body>
</html>